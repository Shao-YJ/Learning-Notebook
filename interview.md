# 小米

## AI应用平台工程师

### 一面

MCP功能与FC的区别

Agent怎么处理上下文的问题

Agent怎么调用MCP，具体逻辑，dify中封装了，我需要自己去了解

### 二面

linux指令：grep、find、sed等指令

数据库：连表查询，join

索引的建立有什么要求：

1. 为高频查询的列创建索引

   - **WHERE 子句中的列**：这是最常见的场景。经常被用于过滤条件的列应该考虑建立索引。
   - **连接（JOIN）操作的列**：例如 `ON table_a.user_id = table_b.user_id`，那么 `user_id` 通常是外键，需要索引。

   - **排序（ORDER BY）和分组（GROUP BY）的列**：索引本身是有序的，可以避免昂贵的文件排序（Filesort）操作。

2. 选择区分度高的列：

   - **区分度** = 不重复的数值 / 总行数。比例越接近1，区分度越高。
   - **优先考虑高区分度的列**：例如“用户ID”、“手机号”等，能快速定位到少量数据。
   - **避免低区分度的列**：例如“性别”只有‘男’、‘女’、‘未知’三种值，建立索引后可能仍需扫描大量数据，性价比低。除非与其他列组成复合索引。

3. 考虑使用复合索引：当多个列经常一起出现在查询条件中时，复合索引比多个单列索引更高效。

   - **最左前缀原则**：这是复合索引的核心规则。索引 `(A, B, C)` 可以被用于只查询 `A`、`A, B` 或 `A, B, C` 的查询，但**不能被**用于只查询 `B` 或 `C` 或 `B, C` 的查询。
   - **列顺序是关键**：
     - **原则1**：将**区分度最高**的列放在最左边，以便尽快缩小筛选范围。
     - **原则2**：考虑查询频率和顺序。将最常用于查询条件的列放在左边。
     - **原则3**：如果某个列经常用于范围查询（`>`， `<`， `BETWEEN`），最好放在后面。因为范围查询后面的列无法使用索引排序。

索引建立要避免的情况：

1. **不要过度索引**
   - **索引会降低写操作（INSERT, UPDATE, DELETE）的速度**：因为每次数据变更，数据库不仅要更新数据，还要更新所有相关的索引文件。
   - **索引占用额外的磁盘空间**。
   - **原则**：一个表通常不建议超过5-6个索引。定期审查并删除未使用或冗余的索引。
2. **避免在频繁更新的列上建立索引**
   - 如果某列经常被 `UPDATE`，那么其上的索引也会被频繁更新，带来额外的性能开销。
3. **谨慎对待长文本列（如 VARCHAR(255)）的索引**
   - 索引键值越长，索引树就越高，查询效率会降低，占用的空间也越大。
   - **解决方案**：
     - **前缀索引**：例如 `INDEX(email(10))`，只对字段的前N个字符建立索引。需要权衡索引长度和区分度。
     - 或者考虑使用哈希列（如存储 `CRC32` 值）并为其建立索引。
4. **注意NULL值的影响**
   - 如果列中包含很多NULL值，查询 `WHERE col IS NULL` 可能会使用索引，但效率取决于数据库优化器的选择和数据分布。

索引为什么能实现加速
